import requests
import json
import psycopg2
import pandas as pd
import io

def get_urls():
    url = "https://www.dnd5eapi.co/api/2014/monsters"
    headers = {
        "Accept": "application/json"
    }

    response = requests.get(url, headers=headers)

    if response.status_code == 200:

        monster_urls = []

        monsters_url_json = response.json()
        for monster in monsters_url_json["results"]:
            monster_urls.append("https://www.dnd5eapi.co" + monster["url"])
        
        return monster_urls
            
    else:
        print(f"Error: {response.status_code}")

def get_data():
    monster_urls = get_urls()
    headers = {
        "Accept": "application/json"
    }
    
    response = requests.get(monster_urls[0], headers=headers)
    if response.status_code == 200:
        read_df = pd.read_json(
            io.StringIO(response.text),
            orient='records'       
        )
        return read_df
            


def main():
    get_data()

if __name__ == "__main__":
    main()